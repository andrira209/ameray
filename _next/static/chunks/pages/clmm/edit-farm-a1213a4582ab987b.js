(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5118],{77742:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/clmm/edit-farm",function(){return n(57847)}])},475:function(e,t,n){"use strict";n.d(t,{u:function(){return l}});var a=n(62512);async function l(){var e;let t=await (0,a.Z)("https://solanacompass.com/api/fees",{cacheFreshTime:3e5}),{avg:n}=null!==(e=null==t?void 0:t[15])&&void 0!==e?e:{};if(n)return{units:4e5,microLamports:Math.min(Math.ceil(1e6*n/4e5),25e3)}}},54531:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(85893);n(67294);var l=n(66180),s=n(70745),i=n(51800);function r(e){let{token1:t,token2:n,size:r,className:o,CoinAvatar1:d,CoinAvatar2:c}=e;return(0,a.jsxs)(i.Z,{className:(0,l.m)("-space-x-1",o),children:[(0,a.jsx)(s.Z,{size:r,token:t,...d}),(0,a.jsx)(s.Z,{size:r,token:n,...c})]})}},54630:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(85893),l=n(97664),s=n(87980),i=n(92224);function r(e){let{tokenSelectorProps:t,...n}=e,[r,{on:o,off:d}]=(0,i.ZP)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{...n,haveCoinIcon:!0,showTokenSelectIcon:!n.disableTokenSelect,onTryToTokenSelect:()=>{var e;o(),null===(e=n.onTryToTokenSelect)||void 0===e||e.call(n)}}),(0,a.jsx)(s.Z,{...t,disableTokens:n.disableTokens,enableTokens:n.enableTokens,canSelectQuantumSOL:n.canSelectQuantumSOL,open:r,onSelectToken:e=>{var t;d(),null===(t=n.onSelectToken)||void 0===t||t.call(n,e)},onClose:d})]})}},34495:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var a=n(85893),l=n(17097),s=n(27993),i=n(67294),r=n(66180),o=n(6994),d=n(54592),c=n(60421),m=n(51800);function u(e){var t,n,u;let{type:x="list-table",className:h,itemClassName:f,rowClassName:p,rowsWrapperClassName:v,headersWrapperClassName:b,list:w,labelMapper:j=Object.keys(w[0]).map(e=>({key:e,label:e})),onClickRow:g,getItemKey:N,renderRowItem:k,renderRowEntry:Z,renderControlButtons:y,renderItemActionButtons:T,renderPropertyLabel:C,onListChange:S}=e,{wrapped:P,controls:I}=function(e,t,n){var a;let l=e.map((e,n)=>null!==(a=t(e,n))&&void 0!==a?a:n).join("-"),[s,r]=(0,i.useState)(e),[o,d]=(0,i.useState)(null==n?void 0:n.searchText);(0,i.useEffect)(()=>{s!==e&&(null==r||r(e))},[l]),(0,i.useEffect)(()=>{var t;s!==e&&(null==n||null===(t=n.onListChange)||void 0===t||t.call(n,s))},[s]);let c=(0,i.useMemo)(()=>s.map((e,t)=>({data:e,destorySelf:()=>{r(e=>e.filter((e,n)=>n!==t))},changeSelf:e=>{r(n=>n.map((n,a)=>a===t?e:n))}})),[s]),m=(0,i.useMemo)(()=>({clear:()=>{r([]),d("")}}),[]);return{wrapped:c,controls:m}}(w,N,{onListChange:S}),R=(0,i.useRef)([]),E=(0,s.u)(j,[Object.keys(null!==(t=w[0])&&void 0!==t?t:{}),w[0]]),A={gridTemplateColumns:E.map(e=>null!==(n=e.cssGridItemWidth)&&void 0!==n?n:"1fr").join(" "),gap:4},D=(e,t)=>{let{data:n}=e;return"list-table"===x?(0,a.jsx)(c.Z,{className:(0,r.m)("text-[#abc4ff] text-xs font-medium py-4 px-5 -mx-5 items-center",(0,s.u)(p,[{index:t,item:n}])),style:A,onClick:()=>{null==g||g({index:t,item:n})},children:E.map(e=>{var s,i;let{key:r,label:o}=e,d=r&&(null===(s=Object.entries(n).find(e=>{let[t,n]=e;return((0,l.hj)(t)?String(t):t).includes(t)}))||void 0===s?void 0:s[1]),c=null===(i=R.current.find(e=>{let{label:t}=e;return t===o}))||void 0===i?void 0:i.el;return(0,a.jsx)("div",{className:f,style:{width:null==c?void 0:c.clientWidth,alignSelf:"stretch"},children:k?k({item:n,index:t,key:r,label:o,wholeDataList:w,allHeaders:R.current,header:c}):r?String(null!=d?d:""):""},o)})}):(0,a.jsx)("div",{className:(0,r.m)("bg-[#141041] p-3 divide-y divide-[#abc4ff1a]",(0,s.u)(p,[{index:t,item:n}])),onClick:()=>{null==g||g({index:t,item:n})},children:E.map(e=>{var s,i;let{key:o,label:d}=e,m=o&&(null===(s=Object.entries(n).find(e=>{let[t,n]=e;return((0,l.hj)(t)?String(t):t).includes(t)}))||void 0===s?void 0:s[1]),u=null===(i=R.current.find(e=>{let{label:t}=e;return t===d}))||void 0===i?void 0:i.el,x=k?k({item:n,index:t,key:o,label:d,wholeDataList:w,allHeaders:R.current,header:u}):o?String(null!=m?m:""):"";return(0,a.jsxs)(c.Z,{className:(0,r.m)("grid-cols-2 py-3",f),children:[(0,a.jsx)("div",{className:"grow text-xs font-semibold text-[#abc4ff80]",children:d}),(0,a.jsx)("div",{className:"text-[#abc4ff] text-xs font-medium",children:x},d)]},d)})})};return"list-table"===x?(0,a.jsxs)(o.Z,{className:(0,r.m)("grid bg-cyberpunk-card-bg border-1.5 border-[rgba(171,196,255,0.2)]",(null==w?void 0:w.length)>0?"":"rounded-bl-none rounded-br-none",h),size:"lg",children:[(0,a.jsx)(c.Z,{className:(0,r.m)("bg-[#141041] px-5 rounded-tr-inherit rounded-tl-inherit items-center",b),style:A,children:E.map((e,t)=>{let{key:n,label:l,renderLabel:s}=e;return(0,a.jsx)(i.Fragment,{children:null!==(u=null==C?void 0:C({key:n,label:l,wholeList:w}))&&void 0!==u?u:(0,a.jsx)("div",{ref:e=>R.current[t]={label:l,el:e},className:"grow text-xs font-semibold text-[#abc4ff80] py-3",children:s?s(w):l})},t)})}),(0,a.jsx)(d.Z,{className:(0,r.m)("px-5 divide-y divide-[#abc4ff1a]",v),children:P.map((e,t)=>{var n;let{data:s,destorySelf:i,changeSelf:r}=e,o=D({data:s,destorySelf:i,changeSelf:r},t),d=null==Z?void 0:Z({contentNode:o,destorySelf:i,changeSelf:r,itemData:s,index:t}),c=null==y?void 0:y({destorySelf:i,changeSelf:r,itemData:s,index:t}),m=null==T?void 0:T({destorySelf:i,changeSelf:r,itemData:s,index:t});return(0,a.jsx)("div",{className:"relative",children:null!=d?d:(0,a.jsxs)(a.Fragment,{children:[o,m,c&&(0,a.jsx)("div",{className:"absolute -right-10 top-1/2 -translate-y-1/2 translate-x-full",children:c})]})},(0,l.Kn)(s)&&null!==(n=null==s?void 0:s.id)&&void 0!==n?n:t)})})]}):(0,a.jsx)(c.Z,{className:(0,r.m)(h,v),children:P.map((e,t)=>{var n;let{data:i,destorySelf:d,changeSelf:c}=e,u=D({data:i,destorySelf:d,changeSelf:c},t),x=null==Z?void 0:Z({contentNode:u,destorySelf:d,changeSelf:c,itemData:i,index:t}),h=null==y?void 0:y({destorySelf:d,changeSelf:c,itemData:i,index:t}),f=null==T?void 0:T({destorySelf:d,changeSelf:c,itemData:i,index:t});return(0,a.jsx)(o.Z,{className:(0,r.m)("grid bg-cyberpunk-card-bg border-1.5 border-[rgba(171,196,255,0.2)] overflow-hidden",(0,s.u)(p,[{item:i,index:t}])),size:"lg",children:x?(0,a.jsx)("div",{className:"relative",children:x}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative",children:[u,f]}),(0,a.jsx)(m.Z,{children:h&&(0,a.jsx)(m.Z,{className:"grow justify-end py-3 px-5",children:h})})]})},(0,l.Kn)(i)&&null!==(n=null==i?void 0:i.id)&&void 0!==n?n:t)})})}},18074:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var a=n(81451),l=n(51523),s=n(84207),i=n(72573),r=n(99881);function o(e,t){try{var n,o;let d=(0,s.Z)(null!=e?e:0),c=d.mul((null==t?void 0:t.alreadyPercented)?1:100).toFixed(null!==(n=null==t?void 0:t.fixed)&&void 0!==n?n:2);if((0,a.eq)(d,0))return"0%";if(!(null==t?void 0:t.exact)&&c===0..toFixed(null!==(o=null==t?void 0:t.fixed)&&void 0!==o?o:2))return(null==t?void 0:t.alwaysSigned)?"<+0.01%":"<0.01%";return(null==t?void 0:t.alwaysSigned)?"".concat((0,a.gt)(c,0)?"+":"-").concat((0,r.Z)((0,a.gt)(c,0)?(0,i.B)(c):(0,i.B)((0,l.dC)(c,-1))),"%"):"".concat((0,r.Z)(c,{fractionLength:null==t?void 0:t.fixed}),"%")}catch(e){return"0%"}}},57847:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return er}});var a=n(85893),l=n(67294),s=n(11163),i=n(76248),r=n(94678),o=n(96662),d=n(31166),c=n(57571),m=n(91371),u=n(75640),x=n(47511),h=n(34003),f=n(51523),p=n(27713),v=n(475),b=n(8667),w=n(53002),j=n(31555),g=n(43067),N=n(48162),k=n(51800),Z=n(92618),y=n(66042),T=n(91148),C=n(4465),S=n(6994),P=n(54630),I=n(25194),R=n(60421),E=n(72259),A=n(56419),D=n(95793),F=n(90547),B=n(81451),M=n(14209);function L(e){var t,n;let{dataIndex:s,defaultData:i,enableTokens:r,disableTokens:d,onValidateChange:c,onUpdateReward:u}=e,x=(0,m.ZP)(e=>e.isMobile),h=(0,o.ZP)(e=>e.chainTimeOffset),p=(0,w.Z)(e=>e.getBalance),[v,b]=(0,l.useState)(i||{}),j=(0,l.useRef)(s),g=Object.keys(v).length>0,N=new Date(Date.now()+(h||0)),Z=v.openTime&&v.endTime&&v.token?(0,f.hi)((0,F.g9)(v.endTime.valueOf(),v.openTime.valueOf())/1e3,10**v.token.decimals):void 0,y=v.token?void 0:"Confirm reward token",T=(0,B.Jr)(v.amount)?"Enter ".concat(null===(t=v.token)||void 0===t?void 0:t.symbol," token amount"):void 0,C=!v.token||!v.amount||(0,B.eg)(p(v.token),v.amount)?void 0:"Insufficient ".concat(v.token.symbol," balance"),L=v.amount&&(0,B.lt)(v.amount,Z)?"Emission rewards is lower than min required":void 0,O=g?y||T||C||L:void 0,W=(0,l.useMemo)(()=>v.openTime&&v.duration?(0,B.gt)(v.duration,90)?"Period is longer than max duration of ".concat(90," days"):(0,B.lt)(v.duration,7)?"Period is shorter than min duration of ".concat(7," days"):void 0:"Confirm emission time setup",[v.duration,v.openTime]);return(0,l.useEffect)(()=>{c(s,y||T||C||L||W)},[y,T,W,L,C,v.amount,c,s]),(0,l.useEffect)(()=>{g&&b(e=>{var t,n,a;let l=null!==(a=null===(t=e.token)||void 0===t?void 0:t.decimals)&&void 0!==a?a:6,s=(0,B.$u)(e.amount)&&(0,B.$u)(e.duration)?(0,M.Lu)((0,f.dC)((0,f.hi)(e.amount,e.duration),7).toFixed(l)):"0";return{...e,endTime:(0,B.$u)(null===(n=e.openTime)||void 0===n?void 0:n.valueOf())&&(0,B.$u)(e.duration)?(0,A.mb)(e.openTime,{milliseconds:864e5*Number(e.duration)}):e.endTime,perWeek:s}})},[v.duration,v.openTime,v.amount,g]),(0,l.useEffect)(()=>{u(v,s)},[u,v,s]),(0,l.useEffect)(()=>{j.current!==s&&i&&b(i),j.current=s},[i,s]),(0,a.jsx)(S.Z,{className:"p-4 mb-4 mobile:p-3 bg-cyberpunk-card-bg border-1.5 border-[rgba(171,196,255,0.2)] ".concat(x?"rounded-2xl":"rounded-3xl"),size:"lg",children:(0,a.jsxs)(R.Z,{className:"gap-4",children:[(0,a.jsxs)(k.Z,{className:"gap-4 mobile:flex-col",children:[(0,a.jsx)(P.Z,{className:"rounded-md grow",haveHalfButton:!0,hasPlaceholder:!0,topLeftLabel:"Token",enableTokens:r,disableTokens:d,value:v.amount||"",token:v.token,onSelectToken:e=>b(t=>({...t,token:e,isWhiteListReward:!!r})),onUserInput:e=>{b(t=>({...t,amount:e}))}}),(0,a.jsx)(E.Z,{className:"grow-2 rounded-md text-sm font-medium text-white px-4",inputClassName:"placeholder:text-[#abc4ff50]",label:"Duration",inputMode:"numeric",inputHTMLProps:{min:1,maxLength:3,step:1},pattern:/^\d{0,5}$/,placeholder:"".concat(7," - ").concat(90),value:v.duration,suffix:(0,a.jsx)("div",{className:"font-medium text-sm text-[#abc4ff80]",children:"Days"}),onUserInput:e=>b(t=>({...t,duration:e}))})]}),O?(0,a.jsx)("div",{className:"text-[#DA2EEF] text-right text-sm font-medium px-2",children:O}):null,(0,a.jsxs)(k.Z,{className:"gap-3 mobile:flex-col",children:[(0,a.jsx)(I.Z,{className:"flex-[3] mobile:w-full rounded-md px-4",label:"Farming Starts",inputProps:{placeholder:"Select date and time",inputClassName:"text-sm font-medium text-white placeholder:text-[#abc4ff50]"},showTime:{format:"Select time: HH:mm UTC"},value:v.openTime?(0,A._3)(v.openTime):void 0,disableDateBeforeCurrent:!0,isValidDate:e=>(0,D.Sl)(e,(0,A.mb)(N,{seconds:-86400}))&&(0,D.hF)(e,(0,A.mb)(v.openTime||N,{seconds:7776e3})),onDateChange:e=>{e&&b(t=>({...t,openTime:(0,A._3)(e)}))}}),(0,a.jsx)(I.Z,{className:"flex-[3] mobile:w-full rounded-md px-4",label:"Farming Ends",inputProps:{placeholder:"Select date and time",inputClassName:"text-sm font-medium text-white placeholder:text-[#abc4ff50]"},showTime:{format:"Select time: HH:mm UTC"},value:v.endTime?(0,A._3)(v.endTime):void 0,disabled:!0,disableDateBeforeCurrent:!0}),(0,a.jsx)(E.Z,{label:"Estimated rewards / week",className:"flex-[3]",onUserInput:e=>b(t=>{var a;return{...t,perWeek:e,amount:(0,B.$u)(t.duration)?(0,M.Lu)((0,f.dC)((0,f.hi)(e,7),t.duration).toFixed(null!==(n=null===(a=t.token)||void 0===a?void 0:a.decimals)&&void 0!==n?n:6)):"0"}}),value:v.perWeek})]}),(0,a.jsx)("div",{children:g&&(0,a.jsx)("div",{children:(0,B.gt)(v.duration,90)?(0,a.jsxs)("div",{className:"text-[#DA2EEF] text-sm font-medium  pl-2",children:["Period is longer than max duration of ",90," days"]}):(0,B.lt)(v.duration,7)?(0,a.jsxs)("div",{className:"text-[#DA2EEF] text-sm font-medium pl-2",children:["Period is shorter than min duration of ",7," days"]}):null})})]})})}var O=n(11601),W=n(70745),U=n(54592),$=n(34495),z=n(99881),H=n(18074),_=n(97664),G=n(6325),q=n(84207);function K(e){var t,n,s;let{open:i,reward:r,disableEndTimeInput:o=!0,chainTimeOffset:d,onClose:c,onConfirm:u}=e,[x,h]=(0,w.Z)(e=>[e.getBalance,e.connected]),[p,v]=(0,l.useState)({amount:"",perWeek:""}),b=null!==(s=null==r?void 0:null===(t=r.rewardToken)||void 0===t?void 0:t.decimals)&&void 0!==s?s:6,j=new Date(Date.now()+(d||0)),{isRewardEnded:N}=r||{},Z=!!((null==r?void 0:r.rewardToken)&&(0,B.eg)(x(r.rewardToken),p.amount));return N?(0,B.$u)(p.amount)&&(0,B.$u)(p.duration)&&(0,f.hi)(p.amount,p.duration).toSignificant(b):(0,M.Lu)((null===(n=(0,f.dC)((0,f.hi)(null==r?void 0:r.perSecond,10**b),86400))||void 0===n?void 0:n.toFixed(b))||""),(0,l.useEffect)(()=>{if(r){var e;v({amount:"",openTime:r.isRewardEnded?void 0:(0,A._3)(r.endTime),perWeek:(0,M.Lu)(null===(e=(0,f.dC)((0,f.hi)(null==r?void 0:r.perSecond,10**b),604800))||void 0===e?void 0:e.toFixed(b))})}},[r,b]),(0,l.useEffect)(()=>{v(e=>{let{duration:t,perWeek:n,...a}=e;if(N){var l;let e=(0,B.$u)(a.amount)&&(0,B.$u)(t)?(0,M.Lu)((0,f.dC)((0,f.hi)(a.amount,t),7).toFixed(b)):"";return{...a,duration:t,perWeek:e,endTime:(0,B.$u)(null===(l=a.openTime)||void 0===l?void 0:l.valueOf())&&(0,B.$u)(p.duration)?(0,A.mb)(a.openTime,{milliseconds:864e5*Number(p.duration)}):a.endTime}}return{...a,duration:t,perWeek:n,amount:n&&t?(0,M.Lu)((0,f.dC)((0,f.hi)(n,7),Number(t)).toFixed(b)):"0",endTime:(0,B.$u)(null==r?void 0:r.endTime.valueOf())&&(0,B.$u)(p.duration)?(0,A.mb)(null==r?void 0:r.endTime,{milliseconds:864e5*Number(p.duration)}):a.endTime}})},[p.duration,p.perWeek,N,b,null==r?void 0:r.endTime]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(G.Z,{placement:"from-bottom",open:i,onClose:c,children:e=>{var t,n;let{close:l}=e;return(0,a.jsxs)(S.Z,{className:"p-8 mobile:p-4 rounded-3xl mobile:rounded-lg w-[min(540px,90vw)] max-h-[80vh] overflow-auto mobile:w-full border-1.5 border-[rgba(171,196,255,0.2)] bg-cyberpunk-card-bg shadow-cyberpunk-card",size:"lg",children:[(0,a.jsx)(k.Z,{className:"justify-between items-center mb-6 mobile:mb-2",children:(0,a.jsx)("div",{className:"mobile:text-base text-xl font-semibold text-white",children:"Add more rewards"})}),(0,a.jsx)(U.Z,{children:(0,a.jsx)(_.Z,{className:"mb-4 py-2 border-none mobile:py-1 px-3 mobile:px-2 border-1.5 border-[#abc4ff40]",disabled:!N,value:p.amount,haveHalfButton:!0,haveCoinIcon:!0,topLeftLabel:"Asset",onUserInput:e=>v(t=>({...t,amount:e,perWeek:(0,B.$u)(e)&&(0,B.$u)(t.duration)?(0,M.Lu)((0,f.dC)((0,f.hi)(e,t.duration),7).toFixed(b)):""})),token:null==r?void 0:r.rewardToken})}),(0,a.jsxs)(k.Z,{className:"gap-4 mb-4",children:[(0,a.jsx)(I.Z,{className:"flex-[3] mobile:w-full rounded-md px-4",label:"Farming Starts",inputProps:{placeholder:"Select date and time",inputClassName:"text-sm font-medium text-white placeholder:text-[#abc4ff50]"},showTime:{format:"Select time: HH:mm UTC"},value:N?p.openTime:(0,A._3)(null==r?void 0:r.endTime),disabled:!N,disableDateBeforeCurrent:!0,isValidDate:e=>(0,D.Sl)(e,(0,A.mb)(j,{seconds:-86400}))&&(0,D.hF)(e,(0,A.mb)(p.openTime,{seconds:7776e3})),onDateChange:e=>{e&&v(t=>({...t,openTime:e,endTime:p.duration?(0,A.mb)(e,{milliseconds:function(e,t){let n=e.trim(),a=isFinite(Number(n))?Number(n):void 0,l="days"===t?a:void 0,s="hours"===t?a:void 0;return(null!=l?l:0)*864e5+(null!=s?s:0)*36e5}(p.duration,"days")}):void 0}))}}),(0,a.jsx)(E.Z,{label:"Duration",className:"flex-[2]",inputHTMLProps:{min:1,maxLength:3,step:1},pattern:/^\d{0,5}$/,placeholder:"7-90",suffix:(0,a.jsx)("span",{className:"text-[#abc4ff80] text-xs",children:"days"}),value:p.duration,onUserInput:e=>v(t=>({...t,duration:e}))})]}),(0,a.jsxs)(k.Z,{className:"gap-4 mb-4",children:[(0,a.jsx)(I.Z,{className:"shrink-0 flex-[3] mobile:w-full rounded-md px-4",label:"Farming Ends",inputProps:{placeholder:o?void 0:"Select date and time",inputClassName:"text-sm font-medium text-white placeholder:text-[#abc4ff50]"},value:p.endTime,disabled:N,disableDateBeforeCurrent:!0,showTime:!1,isValidDate:e=>{let t=(0,D.Sl)(e,(0,A.mb)(p.openTime,{seconds:604800}))&&(0,D.Sl)(e,j)&&(0,D.hF)(e,(0,A.mb)(p.openTime,{seconds:7776e3}));return t},onDateChange:e=>{e&&!N&&v(t=>({...t,duration:(0,f.hi)((0,f.lu)(e.valueOf(),t.openTime.valueOf()),864e5).toFixed(0),endTime:e}))}}),(0,a.jsx)(E.Z,{label:"Estimated rewards / week",className:"flex-[2]",onUserInput:e=>{v(t=>({...t,perWeek:e,amount:N?(0,B.$u)(e)&&(0,B.$u)(t.duration)?(0,f.dC)((0,f.hi)(e,7),t.duration).toFixed(b):"0":t.amount}))},value:p.perWeek})]}),(0,a.jsxs)(k.Z,{className:"justify-between items-center mb-6 mobile:mb-2",children:[(0,a.jsx)(g.Z,{className:"frosted-glass-teal min-w-[120px]",validators:[{should:h,forceActive:!0,fallbackProps:{onClick:()=>m.ZP.setState({isWalletSelectorShown:!0}),children:"Connect wallet"}},{should:(0,B.$u)(p.amount),fallbackProps:{children:"Enter ".concat(null==r?void 0:null===(t=r.rewardToken)||void 0===t?void 0:t.symbol," token amount")}},{should:(0,B.eg)(p.duration,7)&&(0,B.G)(p.duration,90),fallbackProps:{children:"Insufficient duration"}},{should:p.openTime&&p.endTime,fallbackProps:{children:"Confirm emission time setup"}},{should:Z,fallbackProps:{children:"Insufficient ".concat(null==r?void 0:null===(n=r.rewardToken)||void 0===n?void 0:n.symbol," balance")}},{should:p.openTime&&(0,D.hF)(j,p.openTime),fallbackProps:{children:"Insufficient start time"}}],onClick:()=>{var e;u({rewardMint:(null==r?void 0:null===(e=r.rewardToken)||void 0===e?void 0:e.mint.toBase58())||"",data:{openTime:p.openTime.valueOf(),endTime:p.endTime.valueOf(),perSecond:(0,q.Z)((0,f.hi)((0,f.dC)((0,f.hi)(p.perWeek,7),10**b),86400))}}),l()},children:"Save"}),(0,a.jsx)(g.Z,{type:"text",className:"text-sm text-[#ABC4FF] bg-cancel-bg min-w-[120px]",onClick:l,children:"Cancel"})]})]})}})})}var V=n(1758),X=n(95865);let Q={DURATION:"Time extended must be a minimum 7 days and maximum 90 days.",DECREASE_ERROR:"Decreasing reward rate is permitted within 72 hrs of current farm end time. Try adding more tokens.",DECREASE:"Decreasing the reward rate is permitted within 72 hours of current farm end time."};function Y(e){var t;let{defaultData:n,reward:s,chainTimeOffset:i,onClose:r,onConfirm:o}=e,c=(0,m.ZP)(e=>e.isMobile),u=(0,d.ZP)(e=>e.tokenPrices),[x,h]=(0,l.useState)(!!n),p=Date.now()+(null!=i?i:0),[v,b]=(0,w.Z)(e=>[e.getBalance,e.connected]),[j,y]=(0,l.useState)({amount:"",daysExtend:""}),{endTime:T,rewardToken:C,perSecond:P,apr:I,rewardPerWeek:D,tvl:F}=s||{},M=!!(C&&(0,B.eg)(v(C),j.amount)),L=null!==(t=null==C?void 0:C.decimals)&&void 0!==t?t:6,O=(0,l.useMemo)(()=>Math.floor(((T||0)-p)/1e3),[s]),W=Math.ceil(O/86400),q=(0,f.dC)((0,f.hi)((null==P?void 0:P.toFixed(L))||0,10**L),O),K=(0,f.hi)(j.amount||0,(0,f.dC)(j.daysExtend||0,86400)),Y=(0,f.hi)((0,f.PD)(q,j.amount||0),(0,f.PD)(O,(0,f.dC)(j.daysExtend||0,86400))),J=(0,B.lt)(K,Y)?K:Y,ee=(0,f.dC)(J,604800),et=!!s&&(0,B.lt)(J.toFixed(L),(0,f.hi)(P||0,10**L).toFixed(L)),en=(0,B.$u)(j.daysExtend)&&(0,B.eg)(j.daysExtend,7)&&(0,B.G)(j.daysExtend,90),ea="";return x&&!en?ea=Q.DURATION:et&&(ea=O>=0&&O<=259200?Q.DECREASE:Q.DECREASE_ERROR),(0,l.useEffect)(()=>{if(!n)return;let{amount:e="",daysExtend:t=""}=n||{};return y({amount:e,daysExtend:t}),()=>y({amount:"",daysExtend:""})},[n]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(G.Z,{placement:"from-bottom",open:!!s,onClose:r,children:e=>{var t,n;let{close:l}=e;return(0,a.jsxs)(S.Z,{className:"p-8 mobile:p-4 rounded-3xl mobile:rounded-lg w-[min(698px,90vw)] max-h-[80vh] mobile:w-full border-1.5 border-[rgba(171,196,255,0.2)] bg-cyberpunk-card-bg shadow-cyberpunk-card",size:"lg",children:[(0,a.jsxs)(k.Z,{className:"justify-between items-center mb-6 mobile:mb-2",children:[(0,a.jsx)("div",{className:"mobile:text-base text-xl font-semibold text-white",children:"Adjust rewards"}),(0,a.jsx)(N.Z,{heroIconName:"x",className:"cursor-pointer",onClick:r})]}),(0,a.jsxs)("div",{className:"max-h-[calc(80vh-200px)] pr-2 overflow-y-auto overflow-x-hidden",children:[(0,a.jsxs)("div",{className:"bg-[rgba(171,196,255,0.08)] text-secondary-title text-sm p-3 mb-5 rounded-xl",children:[(0,a.jsx)("span",{className:"text-style-color-fuchsia",children:"Please note:"})," You can add more tokens and/or extend the farming period. Any action that will decrease the reward rate can only be done within 72 hours of current farm end time, and the period must be extended by at least 7 days."]}),(0,a.jsx)("div",{className:"text-secondary-title text-sm mb-3",children:"Current rewards period"}),(0,a.jsx)($.Z,{list:s?[s]:[],type:c?"item-card":"list-table",className:c?"gap-4":"",getItemKey:e=>"".concat(e.tokenMint.toBase58(),"-").concat(e.creator.toBase58()),labelMapper:[{label:"Remaining amount",cssGridItemWidth:".7fr"},{label:"Farming ends"},{label:"Rate",cssGridItemWidth:"1fr"}],renderRowItem:e=>{let{label:t}=e;return"Remaining amount"===t?(0,a.jsx)(R.Z,{className:"gap-4 h-full",children:P?(0,a.jsxs)(U.Z,{className:"grow gap-2 break-all justify-center text-xs",children:[(0,a.jsx)("div",{className:"text-white text-base",children:(0,z.Z)(q,{fractionLength:L})}),(0,a.jsx)("div",{children:(0,X.Z)((0,V.Z)((0,f.dC)((0,f.hi)(P.toFixed(L),10**L),O),u[String(null==C?void 0:C.mint)]))})]}):void 0}):"Farming ends"===t?(0,a.jsx)(R.Z,{className:"h-full",children:T?(0,a.jsxs)(U.Z,{className:"justify-center gap-2 text-xs",children:[(0,a.jsx)("span",{className:"text-white text-base",children:(0,A.xn)(T)}),(0,a.jsxs)("span",{children:[W,"D remaining"]})]}):void 0}):"Rate"===t?(0,a.jsx)(R.Z,{className:"gap-4 h-full",children:(0,a.jsxs)(U.Z,{className:"grow justify-center text-xs gap-2",children:[(0,a.jsxs)("div",{className:" text-base",children:[(0,a.jsxs)("span",{className:"text-white",children:[(0,z.Z)(D),"\xa0"]}),null==C?void 0:C.symbol,"/week"]}),I," APR"]})}):void 0}}),(0,a.jsxs)("div",{className:"flex items-center text-secondary-title text-sm mt-5 mb-3",children:["Additional rewards adjustment",(0,a.jsxs)(Z.Z,{children:[(0,a.jsx)(N.Z,{iconClassName:"ml-1",size:"sm",heroIconName:"question-mark-circle"}),(0,a.jsx)(Z.Z.Panel,{children:(0,a.jsx)("div",{className:"max-w-[300px]",children:"Rewards entered below are in addition to rewards remaining in the current rewards period above. Additional rewards will be deposited in the farm from your wallet balance and combined with existing remaining rewards."})})]})]}),(0,a.jsxs)(k.Z,{className:"gap-4 mb-4",children:[(0,a.jsx)(_.Z,{className:"py-2 flex-[2] border-none mobile:py-1 px-3 mobile:px-2 border-1.5 border-[#abc4ff40]",value:j.amount,haveHalfButton:!0,haveCoinIcon:!0,topLeftLabel:"Asset",onUserInput:e=>{y(t=>({...t,amount:e})),h(!0)},token:null==s?void 0:s.rewardToken}),(0,a.jsx)(E.Z,{label:"Days Extended",className:"flex-[1] max-h-[88px]",inputHTMLProps:{min:1,maxLength:3,step:1},pattern:/^\d{0,5}$/,placeholder:"7-90",suffix:(0,a.jsx)("span",{className:"text-[#abc4ff80] text-xs",children:"Days"}),value:j.daysExtend,onUserInput:e=>{y(t=>({...t,daysExtend:e})),h(!0)}})]}),ea&&(0,a.jsx)("div",{className:"text-style-color-fuchsia mb-4",children:ea}),(0,a.jsxs)("div",{className:"flex items-center text-secondary-title text-sm mb-3",children:["Updated rewards period",(0,a.jsxs)(Z.Z,{children:[(0,a.jsx)(N.Z,{iconClassName:"ml-1",size:"sm",heroIconName:"question-mark-circle"}),(0,a.jsx)(Z.Z.Panel,{children:(0,a.jsx)("div",{className:"max-w-[300px]",children:"Updated rewards combines remaining current rewards and additional rewards entered above. Calculations are for the adjusted farming period time and rewards rate."})})]})]}),(0,a.jsx)($.Z,{list:s&&j.amount&&j.daysExtend?[s]:[],type:c?"item-card":"list-table",className:c?"gap-4":"",getItemKey:e=>"".concat(e.tokenMint.toBase58(),"-").concat(e.creator.toBase58()),labelMapper:[{label:"Total amount",cssGridItemWidth:".7fr"},{label:"Farming ends"},{label:"Rate",cssGridItemWidth:"1fr"}],renderRowItem:e=>{let{label:t}=e,n=j.amount||j.daysExtend?(0,H.Z)((0,f.hi)((0,f.dC)((0,f.dC)(J,31536e3),C?u[C.mint.toBase58()]:0),F)):I;return"Total amount"===t?(0,a.jsx)(R.Z,{className:"gap-4 h-full",children:P?(0,a.jsxs)(U.Z,{className:"grow gap-2 break-all justify-center text-xs",children:[(0,a.jsx)("div",{className:"text-white text-base",children:(0,z.Z)(et?(0,f.PD)(j.amount,(0,f.dC)(J,O)).toFixed(L):(0,f.PD)(j.amount,q).toFixed(L),{fractionLength:L})}),(0,a.jsx)("div",{children:(0,X.Z)((0,V.Z)((0,f.PD)(j.amount,q).toFixed(L),u[String(null==C?void 0:C.mint)]))})]}):void 0}):"Farming ends"===t?(0,a.jsx)(R.Z,{className:"h-full",children:T?(0,a.jsxs)(U.Z,{className:"justify-center gap-2 text-xs",children:[(0,a.jsx)("span",{className:"text-white text-base",children:(0,A.xn)((0,A.mb)(T,{days:Number(j.daysExtend||"0")}))}),(0,a.jsxs)("span",{children:[W+Number(j.daysExtend||"0"),"D in Total"]})]}):void 0}):"Rate"===t?(0,a.jsx)(R.Z,{className:"gap-4 h-full",children:(0,a.jsxs)(U.Z,{className:"grow justify-center text-xs gap-2",children:[(0,a.jsxs)("div",{className:" text-base",children:[(0,a.jsxs)("span",{className:"text-white",children:[(0,z.Z)(ee),"\xa0"]}),null==C?void 0:C.symbol,"/week"]}),n," APR"]})}):void 0}})]}),(0,a.jsxs)(k.Z,{className:"justify-between items-center mt-10 mobile:mb-2",children:[(0,a.jsx)(g.Z,{className:"frosted-glass-teal min-w-[120px]",validators:[{should:b,forceActive:!0,fallbackProps:{onClick:()=>m.ZP.setState({isWalletSelectorShown:!0}),children:"Connect wallet"}},{should:(0,B.$u)(j.amount),fallbackProps:{children:"Enter ".concat(null==s?void 0:null===(t=s.rewardToken)||void 0===t?void 0:t.symbol," token amount")}},{should:en,fallbackProps:{children:"Insufficient days extended"}},{should:ea!==Q.DECREASE_ERROR},{should:M,fallbackProps:{children:"Insufficient ".concat(null==s?void 0:null===(n=s.rewardToken)||void 0===n?void 0:n.symbol," balance")}}],onClick:()=>{var e;o({rewardMint:(null==s?void 0:null===(e=s.rewardToken)||void 0===e?void 0:e.mint.toBase58())||"",data:{...j,openTime:p,endTime:(0,A.mb)(T,{days:Number(j.daysExtend)}).valueOf(),perSecond:(0,f.dC)(J,10**L)}}),l()},children:"Save"}),(0,a.jsx)(g.Z,{type:"text",className:"text-sm text-[#ABC4FF] bg-cancel-bg min-w-[120px]",onClick:l,children:"Cancel"})]})]})}})})}function J(e){let{pool:t,onUpdateReward:n,previewMode:s}=e,[i,c]=(0,m.ZP)(e=>[e.isMobile,e.isApprovePanelShown]),x=(0,o.ZP)(e=>e.chainTimeOffset),p=(0,d.ZP)(e=>e.tokenPrices),[j,Z]=(0,l.useState)(),[y,T]=(0,l.useState)(),[C,S]=(0,l.useState)(new Map),P=Date.now()+(null!=x?x:0),I=(0,l.useCallback)(()=>Z(void 0),[]),E=(0,l.useCallback)(()=>T(void 0),[]),M=(0,l.useCallback)(e=>{let{rewardMint:t,data:n}=e;S(e=>(e.set(t,n),new Map(Array.from(e))))},[]),L=(0,l.useCallback)(e=>{S(t=>(t.delete(e),new Map(Array.from(t))))},[]);return(0,l.useEffect)(()=>{n(C)},[C,n]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.Z,{list:t.rewardInfos,type:i?"item-card":"list-table",className:i?"gap-4":"",getItemKey:e=>"".concat(e.tokenMint.toBase58(),"-").concat(e.creator.toBase58()),labelMapper:[{label:"Asset",cssGridItemWidth:".7fr"},{label:"Amount"},{label:"Duration",cssGridItemWidth:"1fr"},{label:"Period",cssGridItemWidth:"1.5fr"},{label:"Rate"}],renderRowItem:e=>{var n,l,s,i;let{item:r,label:o,index:d}=e,{openTime:c,endTime:m,rewardToken:u,perSecond:x,rewardPerWeek:h}=r,v=!!(c&&(0,D.hF)(P,c)),b=!!(m&&(0,D.Sl)(P,m)),w=(0,F.g9)(m,c);function j(e){let t=(0,F.ZP)(e);return t.hours?"".concat(t.days,"D ").concat(t.hours,"H"):"".concat(t.days,"D")}let g=null!==(n=null==u?void 0:u.decimals)&&void 0!==n?n:6,N=C.get(r.rewardToken.mint.toBase58()),Z=N?(0,F.g9)(N.endTime,N.openTime):0,y=!b&&!!N;if("Asset"===o)return r.rewardToken?(0,a.jsx)(U.Z,{className:"h-full gap-1 justify-center",children:(0,a.jsxs)(k.Z,{className:"gap-1 items-center",children:[(0,a.jsx)(W.Z,{token:r.rewardToken,size:"sm"}),(0,a.jsx)("div",{children:null!==(l=r.rewardToken.symbol)&&void 0!==l?l:"UNKNOWN"})]})}):"--";if("Amount"===o)return(0,a.jsxs)(R.Z,{className:"gap-4 h-full",children:[!y&&x?(0,a.jsx)(U.Z,{className:"grow break-all justify-center",children:(0,z.Z)((0,f.dC)((0,f.hi)(x.toFixed(g),10**g),Math.floor(w/1e3)),{fractionLength:g})}):void 0,N&&(0,a.jsx)(U.Z,{className:"grow justify-center text-[#39d0d8]",children:(0,z.Z)((0,f.dC)((0,f.hi)(N.perSecond,10**g),Math.floor(Z/1e3)),{fractionLength:g})})]});if("Duration"===o)return(0,a.jsxs)(R.Z,{className:"h-full gap-3",children:[!y&&c&&m?(0,a.jsx)(U.Z,{className:"justify-center",children:(0,a.jsxs)(k.Z,{className:"break-all items-center gap-1",children:[j(w),b?(0,a.jsx)(O.C,{className:"w-fit",cssColor:"#da2Eef",children:"Ended"}):v?(0,a.jsx)(O.C,{className:"w-fit",cssColor:"#abc4ff",children:"Upcoming"}):(c||m)&&(b||v)?null:(0,a.jsx)(O.C,{className:"w-fit",cssColor:"#39d0d8",children:"Ongoing"})]})}):void 0,N&&(0,a.jsx)(U.Z,{className:"grow justify-center text-[#39d0d8]",children:(0,a.jsxs)(k.Z,{className:"break-all items-center gap-1",children:[j(Z),(0,a.jsx)(O.C,{cssColor:"#39d0d8",children:y?"Updated":"New"})]})})]});if("Period"===o){if(!c||!m)return;return(0,a.jsxs)(R.Z,{className:"gap-4 h-full",children:[!y&&(0,a.jsxs)(U.Z,{className:"grow justify-center",children:[(0,a.jsx)("div",{children:(0,A.xn)(c)}),(0,a.jsx)("div",{children:(0,A.xn)(m)})]}),N&&(0,a.jsxs)(U.Z,{className:"grow justify-center text-[#39d0d8]",children:[(0,a.jsx)("div",{children:(0,A.xn)(N.openTime)}),(0,a.jsx)("div",{children:(0,A.xn)(N.endTime)})]})]})}if("Rate"===o)return(0,a.jsxs)(R.Z,{className:"gap-4 h-full",children:[!y&&(0,a.jsxs)(U.Z,{className:"grow justify-center text-xs",children:[(0,a.jsxs)("div",{children:[(0,z.Z)(h),"/week"]}),t.rewardApr24h[d]&&(0,a.jsxs)("div",{children:[(0,H.Z)(t.rewardApr24h[d])," APR"]})]}),N&&(0,a.jsxs)(U.Z,{className:"grow justify-center text-[#39d0d8]",children:[(0,a.jsxs)("div",{children:[(0,z.Z)((0,f.dC)((0,f.hi)(N.perSecond,10**g),604800),{fractionLength:null!==(i=null===(s=r.rewardToken)||void 0===s?void 0:s.decimals)&&void 0!==i?i:6}),"/week"]}),(0,a.jsxs)("div",{children:[(0,H.Z)((0,f.hi)((0,f.dC)((0,f.dC)((0,f.hi)(N.perSecond,10**g),31536e3),p[r.tokenMint.toBase58()]||0),t.tvl))," ","APR"]})]})]})},renderItemActionButtons:e=>{let{itemData:n,index:l}=e,i=(0,B.gt)(n.remainingRewards,0),{endTime:o}=n,d=!!(o&&(0,D.Sl)(P,o)),m=o-P<=2592e5&&!C.get(n.rewardToken.mint.toBase58())&&!s;if(!d&&!s)return(0,a.jsx)("div",{className:"flex bg-[#abc4ff1a] mobile:bg-transparent items-center rounded-md p-2 mobile:p-0 mb-4 mobile:mb-0 empty:hidden",children:(0,a.jsxs)(g.Z,{onClick:()=>T({...n,apr:(0,H.Z)(t.rewardApr24h[l]),tvl:t.tvl}),noComponentCss:!0,className:"flex flex-1 justify-center items-center text-secondary-title text-xs font-medium clickable mobile:py-4",children:[(0,a.jsx)(N.Z,{className:"mr-1",heroIconName:"pencil",size:"xs"}),"Adjust rewards"]})});if(m){var x,p,j,k,y,S;return(0,a.jsxs)("div",{className:"flex bg-[#abc4ff1a] mobile:bg-transparent items-center rounded-md p-2 mobile:p-0 mb-4 mobile:mb-0 empty:hidden",children:[(0,a.jsxs)(g.Z,{onClick:()=>Z({...n,isRewardEnded:d}),noComponentCss:!0,className:"flex flex-1 justify-center text-secondary-title text-xs font-medium clickable mobile:py-4",children:[(0,a.jsx)(N.Z,{heroIconName:"plus",size:"sm"}),"Add more rewards"]}),(0,a.jsxs)(g.Z,{noComponentCss:!0,disabled:!i||c,onClick:()=>{(function(e){let{currentAmmPool:t,rewardMint:n}=e;return(0,b.ZP)(async e=>{let{transactionCollector:a,baseUtils:{connection:l,owner:s}}=e,{tokenAccountRawInfos:i}=w.Z.getState();(0,h.Z)(t,"not seleted amm pool");let r=t.rewardInfos.find(e=>e.tokenMint.equals(n)).rewardToken.symbol,{innerTransactions:o}=await u.c2c.makeCollectRewardInstructionSimple({connection:l,poolInfo:t.state,ownerInfo:{feePayer:s,wallet:s,tokenAccounts:i,useSOLBalance:!0},rewardMint:n,associatedOnly:!1,computeBudgetConfig:await (0,v.u)(),checkCreateATAOwner:!0});a.add(o,{txHistoryInfo:{title:"Harvested Reward",description:"Harvested: ".concat(r," reward")}})})})({currentAmmPool:t,rewardMint:n.tokenMint}).then(()=>{r.ZP.getState().refreshConcentrated()})},className:"flex flex-1 gap-1 justify-center items-center text-secondary-title text-xs font-medium ".concat(i&&!c?"clickable":"cursor-default opacity-50"," mobile:py-4"),children:[(0,a.jsx)(N.Z,{iconSrc:"/icons/create-farm-roll-back.svg",size:"xs",className:"text-[#abc4ff80]"}),(0,a.jsxs)(U.Z,{className:"items-start",children:["Claim unemmitted rewards",(0,a.jsxs)("span",{className:"text-[#abc4ff80]",children:[null===(x=(0,f.hi)(n.remainingRewards?(0,f.kg)(n.remainingRewards,0):n.remainingRewards,10**(null!==(y=null===(p=n.rewardToken)||void 0===p?void 0:p.decimals)&&void 0!==y?y:6)))||void 0===x?void 0:x.toSignificant(null!==(S=null===(j=n.rewardToken)||void 0===j?void 0:j.decimals)&&void 0!==S?S:6)," ",null===(k=n.rewardToken)||void 0===k?void 0:k.symbol]})]})]})]})}return null},renderControlButtons:e=>{let{itemData:t}=e,n=!!(t.endTime&&(0,D.Sl)(P,t.endTime)),l=C.get(t.rewardToken.mint.toBase58());return C.get(t.rewardToken.mint.toBase58())?(0,a.jsx)(O.C,{className:"cursor-pointer",cssColor:s?"#39d0d8":"#abc4ff",onClick:s?void 0:()=>L(t.rewardToken.mint.toBase58()),children:s?!n&&l?"Updated":"Added":"reset"}):null}}),(0,a.jsx)(K,{open:!!j,reward:j,chainTimeOffset:x,onClose:I,onConfirm:M}),(0,a.jsx)(Y,{defaultData:y?C.get(y.rewardToken.mint.toBase58()):void 0,reward:y,chainTimeOffset:x,onClose:E,onConfirm:M})]})}function ee(e){let{newRewards:t,tvl:n,onClickRow:l,onDelete:s}=e,i=(0,m.ZP)(e=>e.isMobile),r=(0,d.ZP)(e=>e.tokenPrices);return(0,a.jsx)($.Z,{list:t,type:i?"item-card":"list-table",className:i?"gap-4 mb-8":"mb-8",getItemKey:()=>Date.now(),labelMapper:[{label:"Asset",cssGridItemWidth:".7fr"},{label:"Amount"},{label:"Duration",cssGridItemWidth:"1fr"},{label:"Period",cssGridItemWidth:"1.5fr"},{label:"Rate"}],rowClassName:()=>l?"clickable hover:backdrop-brightness-95":"",onClickRow:e=>{let{index:t}=e;return null==l?void 0:l(t)},renderRowItem:e=>{var t,l,s;let{item:i,label:o}=e,{openTime:d,endTime:c,perWeek:m,token:u}=i,x=(0,f.hi)(m,7),h=(0,F.g9)(c||0,d||0),p=(0,B.$u)(x);if("Asset"===o)return i.token?(0,a.jsx)(U.Z,{className:"h-full gap-1 justify-center",children:(0,a.jsxs)(k.Z,{className:"gap-1 items-center",children:[(0,a.jsx)(W.Z,{token:i.token,size:"sm"}),(0,a.jsx)("div",{children:null!==(t=i.token.symbol)&&void 0!==t?t:"UNKNOWN"})]})}):"--";if("Amount"===o)return(0,B.$u)(h)?(0,a.jsx)(R.Z,{className:"gap-4 h-full",children:p?(0,a.jsx)(U.Z,{className:"grow break-all justify-center",children:(0,z.Z)((0,f.dC)(x,Math.floor(h/1e3)/86400),{fractionLength:null!==(l=null==u?void 0:u.decimals)&&void 0!==l?l:6})}):void 0}):null;if("Duration"===o)return(0,a.jsx)(R.Z,{className:"h-full gap-3",children:d&&c?(0,a.jsx)(U.Z,{className:"justify-center",children:(0,a.jsx)(k.Z,{className:"break-all items-center gap-1",children:function(e){let t=(0,F.ZP)(e);return t.hours?"".concat(t.days,"D ").concat(t.hours,"H"):"".concat(t.days,"D")}(h)})}):void 0});if("Period"===o){if(!d||!c)return;return(0,a.jsx)(R.Z,{className:"gap-4 h-full",children:(0,a.jsxs)(U.Z,{className:"grow justify-center",children:[(0,a.jsx)("div",{children:(0,A.xn)(d)}),(0,a.jsx)("div",{children:(0,A.xn)(c)})]})})}if("Rate"===o)return p?(0,a.jsx)(R.Z,{className:"gap-4 h-full",children:(0,a.jsxs)(U.Z,{className:"grow justify-center text-xs",children:[(0,a.jsxs)("div",{children:[(0,z.Z)((0,f.dC)(x,7),{fractionLength:null!==(s=null==u?void 0:u.decimals)&&void 0!==s?s:6}),"/week"]}),(0,a.jsxs)("div",{children:[(0,H.Z)((0,f.hi)((0,f.dC)((0,f.dC)(x,u?r[u.mint.toBase58()]:0),365),n||0))," ","APR"]})]})}):null},renderControlButtons:e=>{let{index:t}=e;return s?(0,a.jsx)(N.Z,{className:"cursor-pointer",heroIconName:"trash",size:"sm",onClick:()=>s(t)}):null}})}var et=n(54531),en=n(99522);function ea(e){let{pool:t}=e,n=(0,m.ZP)(e=>e.isMobile);return(0,a.jsx)($.Z,{className:"mb-8",type:n?"item-card":"list-table",itemClassName:n?"grid-cols-[1fr,2fr]":void 0,list:t?[{id:t.idString,pool:t}]:[],getItemKey:e=>e.id,labelMapper:[{label:"Pool",cssGridItemWidth:"2fr"},{label:"TVL"},{label:"APR",renderLabel:()=>(0,a.jsx)(k.Z,{children:(0,a.jsx)("div",{children:"APR"})})}],renderRowItem:e=>{let{item:t,label:n}=e;if("Pool"===n){var l,s,i,r;return t.id?(0,a.jsxs)(k.Z,{className:"gap-1 items-center",children:[(0,a.jsx)(et.Z,{token1:t.pool.base,token2:t.pool.quote,size:"sm"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:[null!==(i=null===(l=t.pool.base)||void 0===l?void 0:l.symbol)&&void 0!==i?i:"UNKNOWN","-",null!==(r=null===(s=t.pool.quote)||void 0===s?void 0:s.symbol)&&void 0!==r?r:"UNKNOWN"]}),(0,a.jsx)(en.U,{showDigitCount:8,textClassName:"text-[#abc4ff80] text-xs",canCopy:!1,children:t.pool.idString})]})]}):"--"}return"TVL"===n?(0,a.jsx)(U.Z,{className:"justify-center h-full",children:t.pool.tvl?(0,X.Z)(t.pool.tvl,{decimalPlace:0}):"--"}):"APR"===n?(0,a.jsx)(U.Z,{className:"justify-center h-full",children:t.pool.totalApr30d?(0,H.Z)(t.pool.totalApr30d):"--"}):void 0}})}function el(){var e,t;let n=(0,m.ZP)(e=>e.isMobile),s=(0,w.Z)(e=>e.connected),c=(0,d.ZP)(e=>e.getToken),S=(0,d.ZP)(e=>e.sortTokensWithBalance),[P,I]=(0,r.ZP)(e=>[e.currentAmmPool,e.whitelistRewards],i.X),R=(0,w.Z)(e=>e.owner),[E,A]=(0,l.useState)({newRewards:[]}),[D,F]=(0,l.useState)(!1),[B,M]=(0,l.useState)(!1),[O,W]=(0,l.useState)([]),[U,$]=(0,l.useState)(-1),[z,H]=(0,l.useState)(2-((null==P?void 0:P.rewardInfos.length)||0)),_=P&&(null==P?void 0:P.rewardInfos.length)>0,G=((null==P?void 0:P.rewardInfos)||[]).length>0||E.newRewards.filter(e=>!!(null==e?void 0:e.token)).length>0,q=(0,l.useMemo)(()=>{var e,t;return new Set([...I.map(e=>e.toBase58()),null==P?void 0:null===(e=P.base)||void 0===e?void 0:e.mint.toBase58(),null==P?void 0:null===(t=P.quote)||void 0===t?void 0:t.mint.toBase58()])},[I,P]),K=(0,l.useMemo)(()=>(null==P?void 0:P.rewardInfos.some(e=>q.has(e.tokenMint.toBase58())))||E.newRewards.some(e=>{var t;return q.has(null===(t=e.token)||void 0===t?void 0:t.mint.toBase58())}),[P,E,q]),V=G&&(!K&&0===z||(null===(e=E.newRewards[U])||void 0===e?void 0:e.isWhiteListReward))?S((0,T.Do)(Array.from(q).map(e=>c(e)).filter(e=>!P||e&&!P.rewardInfos.some(t=>t.tokenMint.equals(e.mint))).filter(e=>!E.newRewards.some(t=>{var n;return null===(n=t.token)||void 0===n?void 0:n.mint.equals(e.mint)}))),!0):void 0,X=O.findIndex(e=>!!e),Q=z>0&&-1===X,Y=!B&&!!P&&P.rewardInfos.length<=1;(0,l.useEffect)(()=>{P&&H(2-(P.rewardInfos.length||0)-E.newRewards.length)},[null==P?void 0:P.rewardInfos.length,E.newRewards.length]);let et=(0,l.useCallback)((e,t)=>{W(n=>{let a=[...n];return a[e]=t,a})},[]),en=(0,l.useCallback)(()=>{F(!1),M(!0)},[]),el=(0,l.useCallback)(e=>{A(t=>({...t,updateReward:e}))},[]),es=(0,l.useCallback)((e,t)=>{A(n=>{let a=[...n.newRewards];if(a[t]=e,a.filter(e=>!!(null==e?void 0:e.token)).length>1&&!a.find(e=>e.isWhiteListReward)){let e=a.findIndex(e=>{var t;return q.has(null===(t=e.token)||void 0===t?void 0:t.mint.toBase58())});e>-1&&(a[e].isWhiteListReward=!0)}return{...n,newRewards:a}})},[K,q]),ei=(0,l.useCallback)(e=>$(e),[]),er=(0,l.useCallback)(e=>{A(t=>{let n=[...t.newRewards];return n.splice(e,1),n.forEach(e=>e.isWhiteListReward=!1),$(n.length-1),{...t,newRewards:n}}),H(e=>e+1),W(t=>{let n=[...t];return n.splice(e,1),n})},[et]),eo=()=>{let{newRewards:e,updateReward:t}=E,n=Array.from(t||new Map).map(e=>{let t=null==P?void 0:P.rewardInfos.find(t=>t.tokenMint.toBase58()===e[0]);return t&&e[1].openTime<t.endTime?[e[0],{...e[1],openTime:t.endTime}]:(e[1].openTime<=Date.now()&&(e[1].openTime=Date.now()+3e4),e)});!function(e){let{currentAmmPool:t,updateRewards:n,newRewards:a,onTxSuccess:l}=e;(0,b.ZP)(async e=>{let{transactionCollector:s,baseUtils:{connection:i,owner:r}}=e,{tokenAccountRawInfos:d}=w.Z.getState();(0,h.Z)(t,"not seleted amm pool");let c=Array.from(n).map(e=>({mint:new x.nh(e[0]),openTime:Math.floor(e[1].openTime.valueOf()/1e3),endTime:Math.floor(e[1].endTime.valueOf()/1e3),perSecond:(0,p.I2)(e[1].perSecond,20)})),m=a.map(e=>({mint:e.token.mint,openTime:Math.floor(e.openTime.valueOf()/1e3),endTime:Math.floor(e.endTime.valueOf()/1e3),perSecond:(0,p.I2)((0,f.hi)((0,f.dC)(e.perWeek||0,10**e.token.decimals),604800),20)})),b={connection:i,poolInfo:t.state,ownerInfo:{feePayer:r,wallet:r,tokenAccounts:d,useSOLBalance:!0}};if(c.length){let{chainTimeOffset:e}=o.ZP.getState(),n=((null!=e?e:0)+Date.now())/1e3,{innerTransactions:a}=await u.c2c.makeSetRewardsInstructionSimple({...b,chainTime:n,rewardInfos:c,computeBudgetConfig:await (0,v.u)(),checkCreateATAOwner:!0});s.add(a,{txHistoryInfo:{title:"Update rewards",description:"Update rewards in ".concat(t.idString.slice(0,6))},onTxSuccess:m.length?void 0:l})}if(m.length){let{innerTransactions:e}=await u.c2c.makeInitRewardsInstructionSimple({...b,rewardInfos:m,computeBudgetConfig:await (0,v.u)(),checkCreateATAOwner:!0});s.add(e,{txHistoryInfo:{title:"Added new rewards",description:"Added ".concat(a.map(e=>e.token.symbol).join(",")," to ").concat(t.idString.slice(0,6))},onTxSuccess:l})}})}({onTxSuccess:()=>F(!0),currentAmmPool:P,updateRewards:new Map(n),newRewards:e.length>0?e.map(e=>({token:e.token,openTime:e.openTime,endTime:e.endTime,perWeek:e.perWeek})):[]})},ed=(0,l.useCallback)(()=>$(e=>e+1),[]);return((0,l.useEffect)(()=>{P&&!P.rewardInfos.length&&-1===U&&ed()},[P,U,ed]),s&&R&&(0,C.aT)(null==P?void 0:P.creator,R))?(0,a.jsxs)("div",{className:"max-w-[720px]",children:[(0,a.jsxs)("div",{className:"text-2xl mb-4",children:[_?"Edit":"Create"," Farm"]}),(0,a.jsxs)("div",{className:"text-[#C4D6FF] text-sm mb-4",children:["Before creating a farm, make sure to check the",(0,a.jsx)(y.Z,{className:"ml-1",href:"https://docs.raydium.io/raydium/concentrated-liquidity/creating-a-clmm-pool-and-farm",children:"detailed guide"}),"."]}),(0,a.jsx)("div",{className:"text-sm text-secondary-title mb-3",children:"Concentrated liquidity Pool"}),(0,a.jsx)(ea,{pool:P}),(null==P?void 0:P.rewardInfos)&&P.rewardInfos.length>0?(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("div",{className:"text-sm text-secondary-title mb-3",children:"Existing Farming rewards"}),(0,a.jsx)(J,{pool:P,previewMode:B,onUpdateReward:el})]}):null,(E.newRewards.length>1||B&&E.newRewards.length>0)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-sm text-secondary-title mb-3",children:"New farming rewards"}),(0,a.jsx)(ee,{tvl:null==P?void 0:P.tvl,newRewards:E.newRewards,onClickRow:B?void 0:ei,onDelete:B?void 0:er})]}),Y&&(0,a.jsxs)(a.Fragment,{children:[-1!==U?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm text-secondary-title mb-3",children:["New farming rewards",(0,a.jsxs)(Z.Z,{children:[(0,a.jsx)(N.Z,{size:"sm",heroIconName:"question-mark-circle"}),(0,a.jsx)(Z.Z.Panel,{children:(0,a.jsxs)("div",{className:"max-w-[300px]",children:["Two reward tokens can be added to a farm. The first can be any SPL token. ",(0,a.jsx)("br",{}),"If two tokens are added, at least one should be from the token pair of the pool."]})})]})]}),(0,a.jsx)(L,{enableTokens:V,disableTokens:(0,T.Do)([...P?P.rewardInfos.map(e=>e.rewardToken):[],...E.newRewards.map(e=>e.token)]),dataIndex:U,defaultData:E.newRewards[U],onValidateChange:et,onUpdateReward:es},U)]}):null,(0,a.jsxs)(k.Z,{className:"items-center w-fit mb-2 ".concat(Q?"cursor-pointer":"opacity-50 cursor-default"),onClick:Q?ed:void 0,children:[(0,a.jsx)(N.Z,{className:"text-[#abc4ff]",heroIconName:"plus-circle",size:"sm"}),(0,a.jsx)("div",{className:"ml-1.5 text-[#abc4ff] font-base mobile:text-sm",children:"Add reward token"}),(0,a.jsxs)("div",{className:"ml-1.5 text-[#abc4ff80] font-base mobile:text-sm",children:["(",z," more)"]})]})]}),D?(0,a.jsx)("div",{className:"mb-4 text-[#DA2EEF] text-center text-sm",children:"Farming rewards successfully updated"}):null,!B&&(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(g.Z,{className:"frosted-glass-teal mt-12 w-auto",onClick:en,validators:[{should:s,forceActive:!0,fallbackProps:{onClick:()=>m.ZP.setState({isWalletSelectorShown:!0}),children:"Connect wallet"}},{should:(null===(t=E.updateReward)||void 0===t?void 0:t.size)||E.newRewards.length>0},{should:-1===X,fallbackProps:{children:O[X]}}],children:"Review Changes"})}),B&&(0,a.jsxs)(k.Z,{className:"justify-center gap-2",children:[D?(0,a.jsx)(g.Z,{className:"frosted-glass-skygray w-fit",size:n?"sm":"lg",onClick:()=>(0,j.Eh)("/clmm/pools"),children:"Back to Pools"}):(0,a.jsx)(g.Z,{className:"frosted-glass-teal w-fit",onClick:eo,children:"Confirm Farm Changes"}),(0,a.jsx)(g.Z,{className:"frosted-glass-skygray w-fit",size:n?"sm":"lg",onClick:()=>{if(D){window.location.reload();return}M(!1),F(!1)},children:"Edit"})]}),!B&&(0,a.jsxs)("div",{className:"flex mt-12",children:[(0,a.jsx)(N.Z,{className:"text-[#abc4ff] mr-[15px]",heroIconName:"exclamation-circle",size:"md"}),(0,a.jsxs)("div",{className:"p-6 bg-[#1B1659] rounded-[20px] border-1.5 border-[rgba(171,196,255,0.2)] text-left text-sm text-[rgba(196,214,255,0.5)]",children:[(0,a.jsx)("div",{className:"text-[#ABC4FF] font-medium font-base mobile:text-sm",children:"How to adjust existing rewards?"}),(0,a.jsxs)("div",{className:"flex mt-2",children:[(0,a.jsx)("span",{className:"mr-1",children:"1."}),"Rewards allocated to farms ",(0,a.jsx)("span",{className:"px-1 underline",children:"cannot be withdrawn"})," after farming starts."]}),(0,a.jsxs)("div",{className:"flex mt-2",children:[(0,a.jsx)("span",{className:"mr-1",children:"2."}),"If you want to increase the reward rate, additional rewards can be added while a farm is still running. The period must be extended by at least 7 days."]}),(0,a.jsxs)("div",{className:"flex mt-2",children:[(0,a.jsx)("span",{className:"mr-1",children:"3."}),"If you want to decrease the rewards rate, this can only be done 72 hours before the end of the current farming period, and the period must be extended by at least 7 days."]})]})]})]}):s?(0,a.jsx)("div",{className:"max-w-[720px]",children:(0,a.jsxs)("div",{className:"text-xl mb-10 text-secondary-title",children:["Opps! Only pool's owner can ",_?"Edit":"Create"," farm reward"]})}):(0,a.jsxs)("div",{className:"max-w-[720px]",children:[(0,a.jsxs)("div",{className:"text-xl mb-10 text-secondary-title",children:["You must connect your wallet before ",_?"Edit":"Create"," Farm"]}),(0,a.jsx)(g.Z,{className:"w-full frosted-glass-teal mt-5",onClick:()=>m.ZP.setState({isWalletSelectorShown:!0}),children:"Connect Wallet"})]})}var es=n(66180);function ei(){return(0,a.jsx)(k.Z,{className:(0,es.m)("-mt-4 mobile:mt-0.5 mb-8 mobile:mb-2 sticky z-10 -top-4 mobile:top-0 mobile:-translate-y-2 mobile:bg-[#0f0b2f] mobile:hidden items-center justify-between"),children:(0,a.jsx)(g.Z,{type:"text",className:"text-sm text-[#ABC4FF] opacity-50 px-0",prefix:(0,a.jsx)(N.Z,{heroIconName:"chevron-left",size:"sm"}),onClick:()=>(0,j.Eh)("/clmm/pools"),children:"Back to Concentrated Pools"})})}function er(){let e=(0,o.ZP)(e=>e.connection),t=(0,d.ZP)(e=>e.getToken),[n,m]=(0,r.ZP)(e=>[e.hydratedAmmPools,e.fetchWhitelistRewards],i.X),{query:u}=(0,s.useRouter)(),x=null==u?void 0:u.farmId;return(0,l.useEffect)(()=>{if(!x)return;let e=n.find(e=>e.idString===x);e&&r.ZP.setState({currentAmmPool:e})},[x,n]),(0,l.useEffect)(()=>{e&&t&&m()},[m,e,t]),(0,a.jsxs)(c.Z,{metaTitle:"Concentrated Pools - Raydium",children:[(0,a.jsx)(ei,{}),(0,a.jsx)("div",{className:"w-full flex justify-center items-center",children:(0,a.jsx)(el,{})})]})}}},function(e){e.O(0,[4740,7571,8667,7664,7980,5194,9774,2888,179],function(){return e(e.s=77742)}),_N_E=e.O()}]);